<!DOCTYPE html>
<html lang="en">
 
<head>
    <title>PSLab Virtual Lab</title>
 
    
    <script src="/js/jquery.js"></script>        
    <link href="/css/bootstrap.min.css" rel="stylesheet">
 
    <link href="/css/narrow.css" rel="stylesheet">
    <link href="/css/signup.css" rel="stylesheet">
 
</head>
 
<body>
 
    <div class="container">
        <div class="header">
            <nav>
                <ul class="nav nav-pills pull-right">
                    <li role="presentation" class="active"><a href="#">Add Script</a>
                    </li>
                    <li role="presentation"><a href="/logout.html">Logout</a>
                    </li>
                </ul>
            </nav>
            <h3 class="text-muted">New Python Script</h3>
        </div>
        <section>

            <form id="contentForm" class="form-horizontal" >
                <fieldset>
                    <!-- Form Name -->
                    <legend>Create Your Script</legend>
                    <!-- Text input-->
                    <div class="form-group" >
                        <label class="col-md-2 control-label" for="txtTitle">Filename</label>
                        <div class="col-md-10">
                            <input id="txtTitle" name="inputTitle" type="text" placeholder="placeholder" class="form-control input-md">
                        </div>
                    </div>
                    <!-- Ace editor -->
					<pre id="editor" id="inputDescription"></pre>

					<script src="/js/ace-js/ace.js" type="text/javascript" charset="utf-8"></script>
					<script>
						var editor = ace.edit("editor");
						editor.setTheme("ace/theme/cobalt");
						editor.session.setMode("ace/mode/python");
					</script>
                    <!-- Button -->
                    <br>
                    <div class="form-group">
                        <div class="col-md-1">
                            <input id="singlebutton" name="singlebutton" class="btn btn-primary" type="button" value="Publish" />
                        </div>
                    </div>
	            <h3 id="serverResponse" class="text-muted"></h3>

                </fieldset>
            </form>
 
        </section>
 
    </div>
</body>


<script type="text/javascript">
$(function() {
	$('#singlebutton').click(function() {
	        //copy contents to the input element we're going to submit
	        $('<input />').attr('type', 'hidden').attr('name', "inputDescription").attr('value', editor.getValue()).appendTo('#contentForm');
		
		console.log($('#contentForm').serialize());
		
		$.ajax({
			url: '/addScript',
			data: $('#contentForm').serialize(),
			type: 'POST',
			dataType:'json',
			success: function(response) {
				if (response.status==true){
					window.location.href = "/userHome.html";
				}
				else{
					$('#serverResponse').css("color", "red");
					$('#serverResponse').html(String(response.message));
				}
				console.log(response);
			},
			error: function(response) {
				$('#serverResponse').css("color", "red");
				$('#serverResponse').html('Submit failed. Server down? ');
				console.log(response);
			}
		});
	});
});

</script> 
 
 
 
</html>
